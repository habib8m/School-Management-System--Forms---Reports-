
CREATE OR REPLACE VIEW weekly_income AS
SELECT INCOME_DATE INCOME_DATE, NVL(TOTAL_AMOUNT, 0)WeeklyCollection
FROM INCOME_M
WHERE INCOME_DATE BETWEEN (SYSDATE-7) AND SYSDATE
ORDER BY 2;